mysql 锁



## 分类

模式： 乐观锁，悲观锁

按粒度：

- 全局锁
- 表级锁
- 页级锁（BDB引擎）
- 行级锁

按属性：

- 共享锁
- 排它锁

按状态：

- 意向共享锁
- 意向排它锁



## 全局锁

### 使用场景

​	全局逻辑备份（mysqldump）



全局加锁方式：

MySQL 提供了一个加全局读锁的方法，命令是Flush tables with read lock (FTWRL)。



风险点：

如果在主库上备份，那么在备份期间都不能执行更新，业务基本上就能停止。

如果在从库上备份，那么备份期间从库不能执行主库同步过来的binlog，会导致主从延迟。

解决办法：

mysqldump使用参数--single-transaction，启动一个事务，确保拿到一致性视图。而由于MVCC的支持，这个过程中数据是可以正常更新的。







