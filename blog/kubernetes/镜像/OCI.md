# OCI 镜像规范

OCI镜像规范是以Docker镜像规范v2为基础制定的，它定义了镜像的主要格式及内容，主要用于镜像仓库存放镜像及分发镜像等场景，与正在制定的OCI分发规范（参见1.5.2节）密切相关。OCI运行时在创建容器前，要把镜像下载并解压成符合运行时规范的文件系统包，并且把镜像中的配置转化成运行时配置，然后启动容器。



OCI 镜像包括4个部分： 镜像索引（Image Index）， 清单（Manifest），配置（configuration）和层文件（Layers）。

清单是JSON格式的描述文件，列出了镜像的配置和层文件。

配置是JSON格式的描述文件，说明了镜像运行参数。

层文件则是镜像内容，即镜像包含的文件，一般是二进制数据文件格式（Blob)。

一个镜像可以有一个或多个层文件，镜像索引不是必须的，如果存在，则指明了一组支持不同架构平台的相关镜像。镜像的4个部分之间是通过摘要（digest）来相互引用（reference）的。镜像各部分的关系如图1-13所示。



![image-20210507093227627](https://cai-hello-1253732611.cos.ap-shanghai.myqcloud.com/share/013229.png)







镜像分发



![image-20210507093605550](https://cai-hello-1253732611.cos.ap-shanghai.myqcloud.com/share/013607.png)